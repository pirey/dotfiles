#!/bin/sh

# doftiles directory
DOTFILES="$HOME/dotfiles"
if [ "$1" != "" ]; then
    DOTFILES=$1
fi

# uninstall first
$DOTFILES/bin/uninstall

# installing vim-plug plugin manager for vim
echo "-> checking vim-plug (plugin manager)"
if [ ! -e "$HOME/.vim/autoload/plug.vim" ]; then
    echo "-> installing vim-plug..."
    curl -fLo ~/.vim/autoload/plug.vim --create-dirs \
        https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
    echo "OK vim-plug installed"
else
    echo "OK vim-plug already installed"
fi

# TODO get all files dynamically
echo "-> creating symlinks..."

# make sure there is .config folder
mkdir -p $HOME/.config

ln -sf $DOTFILES/.vimrc ~/.vimrc
ln -sf $DOTFILES/.plugin.vim ~/.plugin.vim
ln -sf $DOTFILES/.plugin.config.vim ~/.plugin.config.vim
ln -sf $DOTFILES/.nvim.plugin.vim ~/.nvim.plugin.vim
ln -sf $DOTFILES/.nvim.plugin.config.vim ~/.nvim.plugin.config.vim
ln -sf $DOTFILES/.config.vim ~/.config.vim
ln -sf $DOTFILES/.agignore ~/.agignore
ln -sf $DOTFILES/.aliases ~/.aliases
ln -sf $DOTFILES/.ctags ~/.ctags
ln -sf $DOTFILES/.gitconfig ~/.gitconfig
ln -sf $DOTFILES/.gitignore_global ~/.gitignore_global
ln -sf $DOTFILES/.tmux.conf ~/.tmux.conf
ln -sf $DOTFILES/.editorconfig ~/.editorconfig
mkdir -p $HOME/.config/nvim
mkdir -p $HOME/.config/i3
mkdir -p $HOME/.config/i3status
mkdir -p $HOME/.config/volumeicon
mkdir -p $HOME/.config/rofi
ln -sf $DOTFILES/.config/nvim/init.vim ~/.config/nvim/init.vim
ln -sf $DOTFILES/.config/i3/config ~/.config/i3/config
ln -sf $DOTFILES/.config/i3status/config ~/.config/i3status/config
ln -sf $DOTFILES/.config/volumeicon/volumeicon ~/.config/volumeicon/volumeicon
ln -sf $DOTFILES/.config/rofi/config ~/.config/rofi/config
mkdir -p $HOME/.local/bin
ln -sf $DOTFILES/.local/bin/fuzzy_lock.sh ~/.local/bin/fuzzy_lock.sh
echo "OK symlinks created"

# VIM
echo "-> installing vim plugins..."
vim "+PlugInstall! | qa!"
echo "OK vim plugins installed"

echo "OK All clear"
