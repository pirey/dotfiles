#!/bin/sh

# ========================
# DOTFILES

# doftiles directory
DOTFILES="$HOME/dotfiles"
if [ "$1" != "" ]; then
    DOTFILES=$1
fi

# uninstall first
$DOTFILES/bin/uninstall

# installing vim-plug plugin manager for vim
echo "-> checking vim-plug (plugin manager)"
# make sure there is .vim-plug directory
mkdir -p $HOME/.vim-plug
if [ ! -e "$HOME/.vim-plug/autoload/plug.vim" ]; then
    echo "-> installing vim-plug..."
    curl -fLo $HOME/.vim-plug/autoload/plug.vim --create-dirs \
        https://raw.githubusercontent.com/junegunn/vim-plug/master/plug.vim
    echo "OK vim-plug installed"
else
    echo "OK vim-plug already installed"
fi


# TODO get all files dynamically
echo "-> creating symlinks..."

# make sure there is .config folder
mkdir -p $HOME/.config

# tmux
ln -sf $DOTFILES/.tmux.conf $HOME/.tmux.conf

# global config
ln -sf $DOTFILES/home/.agignore $HOME/.agignore
ln -sf $DOTFILES/home/.ctags $HOME/.ctags
ln -sf $DOTFILES/home/.gitconfig $HOME/.gitconfig
ln -sf $DOTFILES/home/.gitignore_global $HOME/.gitignore_global
ln -sf $DOTFILES/home/.editorconfig $HOME/.editorconfig
ln -sf $DOTFILES/home/.npmrc $HOME/.npmrc
ln -sf $DOTFILES/home/.prettierrc $HOME/.prettierrc

# sh
ln -sf $DOTFILES/home/.aliases $HOME/.aliases
ln -sf $DOTFILES/home/.zshrc $HOME/.zshrc

# .config
ln -sf $DOTFILES/home/.config/nvim $HOME/.config
ln -sf $DOTFILES/home/.config/i3 $HOME/.config
ln -sf $DOTFILES/home/.config/i3status $HOME/.config
ln -sf $DOTFILES/home/.config/volumeicon $HOME/.config
ln -sf $DOTFILES/home/.config/rofi $HOME/.config

# custom scripts
mkdir -p $HOME/.local/bin
ln -sf $DOTFILES/home/.local/bin/fuzzy_lock.sh $HOME/.local/bin/fuzzy_lock.sh


echo "OK symlinks created"

# echo "-> installing vim plugins..."
# vim "+PlugInstall! | qa!"
# echo "OK vim plugins installed"

echo "-> installing neovim plugins..."
nvim "+PlugInstall! | qa!"
echo "OK neovim plugins installed"

echo "OK All clear"
